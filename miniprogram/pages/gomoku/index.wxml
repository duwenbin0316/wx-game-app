<view class="container">
  <view class="game-header">
    <view class="header-top">
      <view class="header-slot header-left">
        <text class="mode-pill">你是：{{mode === 'online' && myColor ? (myColor === 'black' ? '黑棋' : '白棋') : '黑棋'}}</text>
      </view>
      <view class="header-slot header-right">
        <text class="status-text {{mode === 'online' && !winner ? (canPlay ? 'your-turn' : 'waiting') : (winner ? 'finished' : '')}}">{{mode === 'online' ? (winner ? '对局结束' : (canPlay ? '轮到你了' : '等待对手下棋...')) : '自由对弈'}}</text>
      </view>
    </view>

    <view class="players-row">
      <view class="player-card {{currentPlayer === 'black' ? 'active' : ''}} {{myColor === 'black' ? 'my-player' : ''}}">
        <view class="chess-piece black"></view>
        <view class="player-label">
          {{mode === 'online' ? blackName : blackName}}
        </view>
      </view>
      <view class="vs">VS</view>
      <view class="player-card {{currentPlayer === 'white' ? 'active' : ''}} {{myColor === 'white' ? 'my-player' : ''}}">
        <view class="chess-piece white"></view>
        <view class="player-label">
          {{mode === 'online' ? whiteName : whiteName}}
        </view>
      </view>
    </view>
  </view>

  <view class="game-board" bindtap="onBoardTap">
    <view class="board-grid">
      <view class="star-points" aria-hidden="true">
        <view class="star-point star-point-1"></view>
        <view class="star-point star-point-2"></view>
        <view class="star-point star-point-3"></view>
        <view class="star-point star-point-4"></view>
        <view class="star-point star-point-5"></view>
      </view>
      <view class="lines-layer">
        <view wx:for="{{lineGrid}}" wx:key="row" class="board-row">
          <view wx:for="{{lineGrid}}" wx:key="col" class="board-cell"></view>
        </view>
      </view>
      <view class="points-layer" wx:if="{{board.length}}">
        <view wx:for="{{points}}" wx:key="id"
              class="intersection r-{{item.r}} c-{{item.c}}"
              data-row="{{item.r}}"
              data-col="{{item.c}}"
              bindtap="onCellTap">
          <view wx:if="{{board[item.r][item.c] === 'black'}}" class="chess black"></view>
          <view wx:if="{{board[item.r][item.c] === 'white'}}" class="chess white"></view>
        </view>
      </view>
    </view>
  </view>

  <view class="game-controls">
    <view wx:if="{{mode === 'online'}}" class="invite-btn" bindtap="onInviteFriend">邀请好友</view>
    <view wx:if="{{mode === 'online'}}" class="leave-btn" bindtap="onLeaveRoom">离开</view>
    <view class="restart-btn" bindtap="onRestart">重新开始</view>
  </view>
</view>
