<view class="container">
  <view class="game-header">
    <view class="header-top">
      <view class="header-slot header-left">
        <text class="mode-pill">你是：{{mode === 'online' && myColor ? (myColor === 'black' ? '黑棋' : '白棋') : '黑棋'}}</text>
      </view>
      <view class="header-slot header-right">
        <text class="status-text {{mode === 'online' && !winner ? (canPlay ? 'your-turn' : 'waiting') : (winner ? 'finished' : '')}}">{{mode === 'online' ? (winner ? '对局结束' : (canPlay ? '轮到你了' : '等待对手下棋...')) : '自由对弈'}}</text>
      </view>
    </view>

    <view class="players-row">
      <view class="player-card {{currentPlayer === 'black' ? 'active' : ''}} {{myColor === 'black' ? 'my-player' : ''}}">
        <view class="chess-piece black"></view>
        <view class="player-label">
          {{mode === 'online' && roomInfo ? (roomInfo.creatorInfo && roomInfo.creatorInfo.nickName ? roomInfo.creatorInfo.nickName : '玩家1') : '黑棋'}}
        </view>
      </view>
      <view class="vs">VS</view>
      <view class="player-card {{currentPlayer === 'white' ? 'active' : ''}} {{myColor === 'white' ? 'my-player' : ''}}">
        <view class="chess-piece white"></view>
        <view class="player-label">
          {{mode === 'online' && roomInfo ? (roomInfo.whitePlayerInfo && roomInfo.whitePlayerInfo.nickName ? roomInfo.whitePlayerInfo.nickName : '等待加入...') : '白棋'}}
        </view>
      </view>
    </view>
  </view>

  <view class="game-board" bindtap="onBoardTap">
    <view class="board-grid">
      <view wx:for="{{board}}" wx:key="index" class="board-row">
        <view wx:for="{{item}}" wx:for-item="cell" wx:for-index="colIndex" wx:key="colIndex"
              class="board-cell {{cell}}"
              data-row="{{index}}"
              data-col="{{colIndex}}"
              bindtap="onCellTap">
          <view wx:if="{{cell === 'black'}}" class="chess black"></view>
          <view wx:if="{{cell === 'white'}}" class="chess white"></view>
        </view>
      </view>
    </view>
  </view>

  <view class="game-controls">
    <view wx:if="{{mode === 'online'}}" class="leave-btn" bindtap="onLeaveRoom">离开</view>
    <view class="restart-btn" bindtap="onRestart">重新开始</view>
  </view>
</view>
